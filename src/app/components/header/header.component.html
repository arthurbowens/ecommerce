<header 
  class="fixed top-0 left-0 right-0 bg-white z-[1000] transition-all duration-300 ease-out border-b border-gray-100"
  [class.shadow-sm]="headerScrolled">
  <div class="max-w-full mx-auto px-4 md:px-6 lg:px-8 py-4 flex items-center justify-between relative">
    <!-- Logo -->
    <div class="flex-shrink-0 z-10">
      <a routerLink="/inicio" class="flex items-center transition-opacity duration-300 hover:opacity-70">
        <span class="text-2xl md:text-3xl font-light text-[#1a1a1a] tracking-wider uppercase">Soe Lunnetes</span>
      </a>
    </div>

    <!-- Ações - Ícones à Direita -->
    <div class="flex items-center gap-4 md:gap-6 flex-shrink-0" *ngIf="!buscaAberta">
      <button 
        class="bg-transparent border-none cursor-pointer p-2 flex items-center justify-center text-[#1a1a1a] transition-all duration-300 w-10 h-10 hover:opacity-60" 
        (click)="toggleBusca()" 
        aria-label="Buscar">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <a 
        routerLink="/carrinho" 
        class="bg-transparent border-none cursor-pointer p-2 flex items-center justify-center text-[#1a1a1a] transition-all duration-300 w-10 h-10 hover:opacity-60 relative" 
        aria-label="Carrinho">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V17C17 18.1 17.9 19 19 19C20.1 19 21 18.1 21 17V13M9 19.5C9.8 19.5 10.5 20.2 10.5 21C10.5 21.8 9.8 22.5 9 22.5C8.2 22.5 7.5 21.8 7.5 21C7.5 20.2 8.2 19.5 9 19.5ZM20 19.5C20.8 19.5 21.5 20.2 21.5 21C21.5 21.8 20.8 22.5 20 22.5C19.2 22.5 18.5 21.8 18.5 21C18.5 20.2 19.2 19.5 20 19.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span 
          *ngIf="quantidadeCarrinho > 0" 
          class="absolute top-0 right-0 bg-[#1a1a1a] text-white text-[10px] font-normal px-1.5 py-0.5 rounded-full min-w-[18px] h-[18px] flex items-center justify-center leading-tight">
          {{ quantidadeCarrinho }}
        </span>
      </a>
      <button 
        class="bg-transparent border-none cursor-pointer p-2 flex items-center justify-center text-[#1a1a1a] transition-all duration-300 w-10 h-10 hover:opacity-60 md:hidden" 
        (click)="toggleMenu()" 
        [attr.aria-expanded]="menuAberto"
        aria-label="Menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button 
        class="hidden md:flex bg-transparent border-none cursor-pointer p-2 items-center justify-center text-[#1a1a1a] transition-all duration-300 w-10 h-10 hover:opacity-60" 
        (click)="toggleMenu()" 
        [attr.aria-expanded]="menuAberto"
        aria-label="Menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>

    <!-- Busca Expandida -->
    <div 
      *ngIf="buscaAberta" 
      class="absolute left-0 right-0 top-0 bottom-0 bg-white flex items-center px-4 md:px-8 z-20">
      <form 
        class="relative flex items-center w-full max-w-3xl mx-auto" 
        (submit)="realizarBusca(); $event.preventDefault()">
        <input
          type="text"
          class="w-full py-3 pr-14 pl-0 border-0 border-b border-gray-200 bg-transparent text-base font-light text-[#1a1a1a] transition-all duration-300 tracking-wide focus:outline-none focus:border-[#1a1a1a] placeholder:text-gray-400 placeholder:font-light"
          placeholder="Buscar..."
          [(ngModel)]="termoBusca"
          name="busca"
          autofocus
        />
        <button 
          type="submit" 
          class="absolute right-10 bg-transparent border-none cursor-pointer p-2 flex items-center justify-center text-[#1a1a1a] transition-all duration-300 hover:opacity-60" 
          aria-label="Buscar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <button 
          type="button" 
          class="absolute right-0 bg-transparent border-none cursor-pointer p-2 flex items-center justify-center text-[#1a1a1a] transition-all duration-300 w-10 h-10 hover:opacity-60" 
          (click)="fecharBusca()" 
          aria-label="Fechar busca">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </form>
    </div>
  </div>
</header>

<!-- Sidebar Menu Lateral Direito (estilo Miu Miu) - Fora do header -->
<nav 
  class="fixed top-0 right-0 bottom-0 z-[1001] pointer-events-none transition-all duration-500"
  [class.pointer-events-auto]="menuAberto">
  <!-- Overlay -->
  <div 
    class="absolute inset-0 bg-black/40 transition-opacity duration-500"
    [class.opacity-0]="!menuAberto"
    [class.opacity-100]="menuAberto"
    (click)="fecharMenu()"></div>
  
  <!-- Sidebar -->
  <div 
    class="absolute top-0 right-0 bottom-0 w-full sm:w-[480px] bg-white transition-transform duration-500 ease-out flex flex-col shadow-[-4px_0_40px_rgba(0,0,0,0.15)]"
    [class.translate-x-full]="!menuAberto"
    [class.translate-x-0]="menuAberto">
      <!-- Header do Sidebar -->
      <div class="flex items-center justify-between p-6 border-b border-gray-100">
        <h2 class="text-xl font-light tracking-wider uppercase text-[#1a1a1a]">Menu</h2>
        <button 
          (click)="fecharMenu()"
          class="w-10 h-10 flex items-center justify-center hover:bg-gray-50 transition-colors rounded-full"
          aria-label="Fechar menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- Conteúdo do Sidebar -->
      <div class="flex-1 overflow-y-auto">
        <ul class="flex flex-col list-none m-0 p-0">
          <li>
            <a 
              routerLink="/inicio" 
              routerLinkActive="ativo" 
              [routerLinkActiveOptions]="{exact: true}" 
              (click)="fecharMenu()" 
              class="flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 [&.ativo]:bg-gray-50 [&.ativo]:font-medium">
              <span>Início</span>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </a>
          </li>
          
          <!-- Coleções -->
          <li>
            <button 
              (click)="toggleMenuColecoes()"
              class="w-full text-left flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 bg-transparent border-none cursor-pointer">
              <span>Coleções</span>
              <svg class="w-5 h-5 transition-transform duration-300" [class.rotate-90]="menuColecoesAberto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </button>
            <ul *ngIf="menuColecoesAberto" class="bg-gray-50/50 border-b border-gray-50">
              <li><a routerLink="/colecoes/oculos-sol" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Óculos de Sol</a></li>
              <li><a routerLink="/colecoes/oculos-grau" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Óculos de Grau</a></li>
              <li><a routerLink="/colecoes/edicao-limitada" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Edição Limitada</a></li>
            </ul>
          </li>

          <!-- Loja Online -->
          <li>
            <button 
              (click)="toggleMenuLoja()"
              class="w-full text-left flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 bg-transparent border-none cursor-pointer">
              <span>Loja Online</span>
              <svg class="w-5 h-5 transition-transform duration-300" [class.rotate-90]="menuLojaAberto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </button>
            <ul *ngIf="menuLojaAberto" class="bg-gray-50/50 border-b border-gray-50">
              <li><a routerLink="/produtos" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Todos os Produtos</a></li>
              <li><a routerLink="/produtos?filtro=novidades" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Novidades</a></li>
              <li><a routerLink="/produtos?filtro=mais-vendidos" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Mais Vendidos</a></li>
            </ul>
          </li>

          <li>
            <a 
              routerLink="/nossa-historia" 
              routerLinkActive="ativo"
              (click)="fecharMenu()" 
              class="flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 [&.ativo]:bg-gray-50 [&.ativo]:font-medium">
              <span>Nossa História</span>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </a>
          </li>

          <!-- Guias -->
          <li>
            <button 
              (click)="toggleMenuGuias()"
              class="w-full text-left flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 bg-transparent border-none cursor-pointer">
              <span>Guias</span>
              <svg class="w-5 h-5 transition-transform duration-300" [class.rotate-90]="menuGuiasAberto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </button>
            <ul *ngIf="menuGuiasAberto" class="bg-gray-50/50 border-b border-gray-50">
              <li><a routerLink="/guias/como-escolher" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Como Escolher Seus Óculos</a></li>
              <li><a routerLink="/guias/cuidados" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Cuidados e Manutenção</a></li>
              <li><a routerLink="/guias/faq" (click)="fecharMenu()" class="block py-3 px-6 pl-12 text-sm text-[#666] hover:bg-gray-100 hover:text-[#1a1a1a] transition-colors">Perguntas Frequentes</a></li>
            </ul>
          </li>

          <li>
            <a 
              routerLink="/blog" 
              routerLinkActive="ativo"
              (click)="fecharMenu()" 
              class="flex items-center justify-between py-4 px-6 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 border-b border-gray-50 hover:bg-gray-50 [&.ativo]:bg-gray-50 [&.ativo]:font-medium">
              <span>Blog</span>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7"/>
              </svg>
            </a>
          </li>
        </ul>
      </div>

      <!-- Footer do Sidebar -->
      <div class="p-6 border-t border-gray-100 bg-gray-50/50">
        <a 
          routerLink="/carrinho" 
          (click)="fecharMenu()" 
          class="flex items-center gap-3 p-4 text-[#1a1a1a] font-light text-sm tracking-wider uppercase transition-all duration-300 hover:bg-white rounded">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V17C17 18.1 17.9 19 19 19C20.1 19 21 18.1 21 17V13M9 19.5C9.8 19.5 10.5 20.2 10.5 21C10.5 21.8 9.8 22.5 9 22.5C8.2 22.5 7.5 21.8 7.5 21C7.5 20.2 8.2 19.5 9 19.5ZM20 19.5C20.8 19.5 21.5 20.2 21.5 21C21.5 21.8 20.8 22.5 20 22.5C19.2 22.5 18.5 21.8 18.5 21C18.5 20.2 19.2 19.5 20 19.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="flex-1">Carrinho</span>
          <span 
            *ngIf="quantidadeCarrinho > 0" 
            class="bg-[#1a1a1a] text-white text-xs font-normal px-2.5 py-1 rounded-full min-w-6 text-center">
            {{ quantidadeCarrinho }}
          </span>
        </a>
      </div>
    </div>
  </nav>
